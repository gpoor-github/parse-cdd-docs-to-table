"Section"	"section_id"	"req_id"	"Test Availability"	"class_def"	"method"	"module"	"method_text"	"full_key"	"requirement"	"key_as_number"	"search_terms"	"manual_search_terms"	"not_search_terms"	"not_files"	"matched_terms"	"search_roots"	"qualified_method"	"max_matches"	"file_name"	"matched_files"	"methods_string"	"urls"	"protected"	"Area"	"Shortened"	"Test Level"
"99:387158) 4  . Application Packaging Compatibility"	"4"	"C-0-1"	""	""	""	""	""	"4/C-0-1"	"""C-0-1] MUST be capable of installing and running Android “.apk” files as generated by the “aapt” tool included in the official Android SDK. As the above requirement may be challenging, device implementations are RECOMMENDED to use the AOSP reference implementation's package management system. Device implementations: """	"04000000.670001"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"99:387158) 4  . Application Packaging Compatibility"	"4"	"C-0-8"	""	""	""	""	""	"4/C-0-8"	"""C-0-8] MUST implement support for Incremental File System as documented here.  && C-0-8] MUST implement support for Incremental File System as documented here.  | C-0-8] and"""	"04000000.670008"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"243:727056) 9.5  . Multi"	"9.5"	"C-1-1"	""	""	""	""	""	"9.5/C-1-1"	"""C-1-1] MUST meet the following requirements related to multi-user support. """	"09050000.670101"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"99:387158) 4  . Application Packaging Compatibility"	"4"	"C-0-4"	""	""	""	""	""	"4/C-0-4"	"""C-0-4] MUST NOT allow apps other than the current ""installer of record"" for the package to silently uninstall the app without any user confirmation, as documented in the SDK for the DELETE_PACKAGE permission. The only exceptions are the system package verifier app handling PACKAGE_NEEDS_VERIFICATION intent and the storage manager app handling ACTION_MANAGE_STORAGE intent. """	"04000000.670004"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"262:762681) 9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-9"	""	""	""	""	""	"9.9.3.1/C-1-9"	"""C-1-9] CE keys MUST be bound to a default passcode when the user has not specified lock screen credentials. """	"09090301.670109"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"99:387158) 4  . Application Packaging Compatibility"	"4"	"C-0-9"	""	""	""	""	""	"4/C-0-9"	"""C-0-9] MUST support verifying .apk files using the APK Signature Scheme v4. If device implementations are already launched on an earlier Android version and cannot meet the requirements && C-0-9] MUST support verifying .apk files using the APK Signature Scheme v4. If device implementations are already launched on an earlier Android version and cannot meet the requirements | C-0-9] through a system software update, they MAY be exempted from these requirements. <h2 id=""5_multimedia_compatibility"" """	"04000000.670009"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"95:373158) 3.15  . Instant Apps"	"3.15"	"C-1-4"	""	""	""	""	""	"3.15/C-1-4"	"""C-1-4] MUST allow running Instant Apps to be accessed from the Recents function if the Recents function is available on the device. """	"03150000.670104"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"262:762681) 9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-12"	""	""	""	""	""	"9.9.3.1/C-1-12"	"""C-1-12] If the device has Advanced Encryption Standard (AES) instructions (such as ARMv8 Cryptography Extensions on ARM-based devices, or AES-NI on x86-based devices) then the AES-based options above for file name, file contents, and filesystem metadata encryption MUST be used, not Adiantum. """	"09090301.670112"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"262:762681) 9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-6"	""	""	""	""	""	"9.9.3.1/C-1-6"	"""C-1-6] MUST encrypt file names using AES-256-CBC-CTS or Adiantum. """	"09090301.670106"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"81:347552) 3.8.14  . Multi"	"3.8.14"	"C-2-1"	""	""	""	""	""	"3.8.14/C-2-1"	"""C-2-1] MUST preload a resizeable launcher as the default. """	"03081400.670201"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"178:575809) 7.3.4  . Gyroscope"	"7.3.4"	"A-2-2"	""	""	""	""	""	"7.3.4/A-2-2"	""">7.3.4/A-2-2] MUST also implement the TYPE_GYROSCOPE_UNCALIBRATED sensor. [<a href=""#7_3_sensors"""""	"07030400.650202"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"262:762681) 9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-7"	""	""	""	""	""	"9.9.3.1/C-1-7"	"""C-1-7] MUST be cryptographically bound to a hardware-backed Keystore. This keystore MUST be bound to Verified Boot and the device's hardware root of trust. """	"09090301.670107"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"95:373158) 3.15  . Instant Apps"	"3.15"	"C-1-5"	""	""	""	""	""	"3.15/C-1-5"	"""C-1-5] MUST preload one or more applications or service components with an intent handler for the intents listed in the SDK here and make the intents visible for Instant Apps. <h3 id=""3_16_companion_device_pairing"" """	"03150000.670105"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"99:387158) 4  . Application Packaging Compatibility"	"4"	"C-0-2"	""	""	""	""	""	"4/C-0-2"	"""C-0-2] MUST support verifying “.apk” files using the APK Signature Scheme v3 , APK Signature Scheme v2 and JAR signing. """	"04000000.670002"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"262:762681) 9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-8"	""	""	""	""	""	"9.9.3.1/C-1-8"	"""C-1-8] CE keys MUST be bound to a user's lock screen credentials. """	"09090301.670108"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"99:387158) 4  . Application Packaging Compatibility"	"4"	"C-0-6"	""	""	""	""	""	"4/C-0-6"	"""C-0-6] MUST NOT install application packages from unknown sources, unless the app that requests the installation meets all the following requirements: It MUST declare the REQUEST_INSTALL_PACKAGES permission or have the android:targetSdkVersion set at 24 or lower. It MUST have been granted permission by the user to install apps from unknown sources. SHOULD provide a user affordance to grant/revoke the permission to install apps from unknown sources per application, but MAY choose to implement this as a no-op and return RESULT_CANCELED for startActivityForResult(), if the device implementation does not want to allow users to have this choice. However, even in such cases, they SHOULD indicate to the user why there is no such choice presented. """	"04000000.670006"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"262:762681) 9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-10"	""	""	""	""	""	"9.9.3.1/C-1-10"	"""C-1-10] MUST be unique and distinct, in other words no user's CE or DE key matches any other user's CE or DE keys. """	"09090301.670110"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"263:763999) 9.9.3.2  . Per"	"9.9.3.2"	"C-1-6"	""	""	""	""	""	"9.9.3.2/C-1-6"	"""C-1-6] MUST be bound to the corresponding user's lock screen credentials. Per-user block-level encryption can be implemented using the Linux kernel “dm-crypt” feature over per-user partitions. <h4 id=""9_9_4_resume_on_reboot"" """	"09090302.670106"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"263:763999) 9.9.3.2  . Per"	"9.9.3.2"	"C-1-3"	""	""	""	""	""	"9.9.3.2/C-1-3"	"""C-1-3] MUST use unique and distinct encryption keys per-user for encryption of the underlying block devices. """	"09090302.670103"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"71:328927) 3.8.4  . Search"	"3.8.4"	"C-1-1"	""	""	""	""	""	"3.8.4/C-1-1"	"""C-1-1] MUST implement the APIs that allow third-party applications to add suggestions to the search box when it is run in global search mode. If no third-party applications are installed that make use of the global search: The default behavior SHOULD be to display web search engine results and suggestions. Android also includes the Assist APIs to allow applications to elect how much information of the current context is shared with the assistant on the device. If device implementations support the Assist action, they: """	"03080400.670101"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"95:373158) 3.15  . Instant Apps"	"3.15"	"C-1-2"	""	""	""	""	""	"3.15/C-1-2"	"""C-1-2] MUST provide a user affordance to view and delete Instant Apps locally cached for each individual app package. """	"03150000.670102"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"262:762681) 9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-5"	""	""	""	""	""	"9.9.3.1/C-1-5"	"""C-1-5] MUST encrypt file contents and filesystem metadata using AES-256-XTS or Adiantum. AES-256-XTS refers to the Advanced Encryption Standard with a 256-bit cipher key length, operated in XTS mode; the full length of the key is 512 bits. Adiantum refers to Adiantum-XChaCha12-AES, as specified at https://github.com/google/adiantum. Filesystem metadata is data such as file sizes, ownership, modes, and extended attributes (xattrs). """	"09090301.670105"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"263:763999) 9.9.3.2  . Per"	"9.9.3.2"	"C-1-4"	""	""	""	""	""	"9.9.3.2/C-1-4"	"""C-1-4] MUST use AES-256-XTS for block-level encryption of the user partitions. The keys protecting the per-user block-level encrypted devices: """	"09090302.670104"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"95:373158) 3.15  . Instant Apps"	"3.15"	"C-1-3"	""	""	""	""	""	"3.15/C-1-3"	"""C-1-3] MUST provide a persistent user notification that can be collapsed while an Instant App is running in the foreground. This user notification MUST include that Instant Apps do not require installation and provide a user affordance that directs the user to the application info screen in Settings. For Instant Apps launched via web intents, as defined by using an intent with action set to Intent.ACTION_VIEW and with a scheme of ""http"" or ""https"", an additional user affordance SHOULD allow the user not to launch the Instant App and launch the associated link with the configured web browser, if a browser is available on the device. """	"03150000.670103"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"262:762681) 9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-14"	""	""	""	""	""	"9.9.3.1/C-1-14"	"""C-1-14] MUST NOT use the same File Based Encryption (FBE) keys or subkeys for different cryptographic purposes (e.g. for both encryption and key derivation, or for two different encryption algorithms). The keys protecting CE and DE storage areas and filesystem metadata: """	"09090301.670114"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"263:763999) 9.9.3.2  . Per"	"9.9.3.2"	"C-1-5"	""	""	""	""	""	"9.9.3.2/C-1-5"	"""C-1-5] MUST be cryptographically bound to a hardware-backed Keystore. This keystore MUST be bound to Verified Boot and the device's hardware root of trust. """	"09090302.670105"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"99:387158) 4  . Application Packaging Compatibility"	"4"	"C-0-7"	""	""	""	""	""	"4/C-0-7"	"""C-0-7] MUST display a warning dialog with the warning string that is provided through the system API PackageManager.setHarmfulAppWarning to the user before launching an activity in an application that has been marked by the same system API PackageManager.setHarmfulAppWarning as potentially harmful. SHOULD provide a user affordance to choose to uninstall or launch an application on the warning dialog. """	"04000000.670007"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"99:387158) 4  . Application Packaging Compatibility"	"4"	"C-0-5"	""	""	""	""	""	"4/C-0-5"	"""C-0-5] MUST have an activity that handles the android.settings.MANAGE_UNKNOWN_APP_SOURCES intent. """	"04000000.670005"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"262:762681) 9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-13"	""	""	""	""	""	"9.9.3.1/C-1-13"	"""C-1-13] MUST use a cryptographically strong and non-reversible key derivation function (e.g. HKDF-SHA512) to derive any needed subkeys (e.g. per-file keys) from the CE and DE keys. ""Cryptographically strong and non-reversible"" means that the key derivation function has a security strength of at least 256 bits and behaves as a pseudorandom function family over its inputs. """	"09090301.670113"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"263:763999) 9.9.3.2  . Per"	"9.9.3.2"	"C-1-1"	""	""	""	""	""	"9.9.3.2/C-1-1"	"""C-1-1] MUST enable multi-user support as described in section 9.5. """	"09090302.670101"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"99:387158) 4  . Application Packaging Compatibility"	"4"	"C-0-3"	""	""	""	""	""	"4/C-0-3"	"""C-0-3] MUST NOT extend either the .apk, Android Manifest, Dalvik bytecode, or RenderScript bytecode formats in such a way that would prevent those files from installing and running correctly on other compatible devices. """	"04000000.670003"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"262:762681) 9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-11"	""	""	""	""	""	"9.9.3.1/C-1-11"	"""C-1-11] MUST use the mandatorily supported ciphers, key lengths and modes. SHOULD make preinstalled essential apps (e.g. Alarm, Phone, Messenger) Direct Boot aware. The upstream Android Open Source project provides a preferred implementation of File Based Encryption based on the Linux kernel ""fscrypt"" encryption feature, and of Metadata Encryption based on the Linux kernel ""dm-default-key"" feature. <h4 id=""9_9_3_2_per-user_block-level_encryption"" """	"09090301.670111"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"263:763999) 9.9.3.2  . Per"	"9.9.3.2"	"C-1-2"	""	""	""	""	""	"9.9.3.2/C-1-2"	"""C-1-2] MUST provide per-user partitions, either using raw partitions or logical volumes. """	"09090302.670102"	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
