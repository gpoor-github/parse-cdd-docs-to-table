"Section"	"section_id"	"req_id"	"full_key"	"key_as_number"	"requirement"	"Test Availability"	"search_roots"	"search_terms"	"manual_search_terms"	"not_search_terms"	"not_files"	"max_matches"	"protected"	"Area"	"Shortened"	"Test Level"	"class_def"	"method"	"module"	"file_name"	"matched_files"	"methods_string"	"urls"	"method_text"	"matched_terms"	"qualified_method"
"9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-10"	"9.9.3.1/C-1-10"	"09090301.670110"	"""C-1-10] MUST be unique and distinct, in other words no user's CE or DE key matches any other user's CE or DE keys."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-6"	"9.9.3.1/C-1-6"	"09090301.670106"	"""C-1-6] MUST encrypt file names using AES-256-CBC-CTS or Adiantum."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"3.15  . Instant Apps"	"3.15"	"C-1-3"	"3.15/C-1-3"	"03150000.670103"	"""C-1-3] MUST provide a persistent user notification that can be collapsed while an Instant App is running in the foreground. This user notification MUST include that Instant Apps do not require installation and provide a user affordance that directs the user to the application info screen in Settings. For Instant Apps launched via web intents, as defined by using an intent with action set to Intent.ACTION_VIEW and with a scheme of ""http"" or ""https"", an additional user affordance SHOULD allow the user not to launch the Instant App and launch the associated link with the configured web browser, if a browser is available on the device."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"3.8.14  . Multi"	"3.8.14"	"C-2-1"	"3.8.14/C-2-1"	"03081400.670201"	"""C-2-1] MUST preload a resizeable launcher as the default."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"3.15  . Instant Apps"	"3.15"	"C-1-5"	"3.15/C-1-5"	"03150000.670105"	"""C-1-5] MUST preload one or more applications or service components with an intent handler for the intents listed in the SDK here and make the intents visible for Instant Apps. <h3 id=""3_16_companion_device_pairing"" """	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-5"	"9.9.3.1/C-1-5"	"09090301.670105"	"""C-1-5] MUST encrypt file contents and filesystem metadata using AES-256-XTS or Adiantum. AES-256-XTS refers to the Advanced Encryption Standard with a 256-bit cipher key length, operated in XTS mode; the full length of the key is 512 bits. Adiantum refers to Adiantum-XChaCha12-AES, as specified at https://github.com/google/adiantum. Filesystem metadata is data such as file sizes, ownership, modes, and extended attributes (xattrs)."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-9"	"9.9.3.1/C-1-9"	"09090301.670109"	"""C-1-9] CE keys MUST be bound to a default passcode when the user has not specified lock screen credentials."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.2  . Per"	"9.9.3.2"	"C-1-4"	"9.9.3.2/C-1-4"	"09090302.670104"	"""C-1-4] MUST use AES-256-XTS for block-level encryption of the user partitions. The keys protecting the per-user block-level encrypted devices:"""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-8"	"9.9.3.1/C-1-8"	"09090301.670108"	"""C-1-8] CE keys MUST be bound to a user's lock screen credentials."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"3.15  . Instant Apps"	"3.15"	"C-1-2"	"3.15/C-1-2"	"03150000.670102"	"""C-1-2] MUST provide a user affordance to view and delete Instant Apps locally cached for each individual app package."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"3.15  . Instant Apps"	"3.15"	"C-1-4"	"3.15/C-1-4"	"03150000.670104"	"""C-1-4] MUST allow running Instant Apps to be accessed from the Recents function if the Recents function is available on the device."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"7.3.4  . Gyroscope"	"7.3.4"	"A-2-2"	"7.3.4/A-2-2"	"07030400.650202"	"""[7.3.4/A-2-2] MUST also implement the TYPE_GYROSCOPE_UNCALIBRATED sensor. """	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-11"	"9.9.3.1/C-1-11"	"09090301.670111"	"""C-1-11] MUST use the mandatorily supported ciphers, key lengths and modes. SHOULD make preinstalled essential apps (e.g. Alarm, Phone, Messenger) Direct Boot aware. The upstream Android Open Source project provides a preferred implementation of File Based Encryption based on the Linux kernel ""fscrypt"" encryption feature, and of Metadata Encryption based on the Linux kernel ""dm-default-key"" feature. <h4 id=""9_9_3_2_per-user_block-level_encryption"" """	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.2  . Per"	"9.9.3.2"	""	"9.9.3.2"	"09090302.48"	"""data-text="" 9.9.3.2. Per-User Block-Level Encryption ""> 9.9.3.2. Per-User Block-Level Encryption If device implementations use per-user block-level encryption, they: [C-1-1] MUST enable multi-user support as described in section 9.5. [C-1-2] MUST provide per-user partitions, either using raw partitions or logical volumes. [C-1-3] MUST use unique and distinct encryption keys per-user for encryption of the underlying block devices. [C-1-4] MUST use AES-256-XTS for block-level encryption of the user partitions. The keys protecting the per-user block-level encrypted devices: [C-1-5] MUST be cryptographically bound to a hardware-backed Keystore. This keystore MUST be bound to Verified Boot and the device's hardware root of trust. [C-1-6] MUST be bound to the corresponding user's lock screen credentials. Per-user block-level encryption can be implemented using the Linux kernel “dm-crypt” feature over per-user partitions. <h4 id=""9_9_4_resume_on_reboot"" """	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.2  . Per"	"9.9.3.2"	"C-1-3"	"9.9.3.2/C-1-3"	"09090302.670103"	"""C-1-3] MUST use unique and distinct encryption keys per-user for encryption of the underlying block devices."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.2  . Per"	"9.9.3.2"	"C-1-1"	"9.9.3.2/C-1-1"	"09090302.670101"	"""C-1-1] MUST enable multi-user support as described in section 9.5."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-12"	"9.9.3.1/C-1-12"	"09090301.670112"	"""C-1-12] If the device has Advanced Encryption Standard (AES) instructions (such as ARMv8 Cryptography Extensions on ARM-based devices, or AES-NI on x86-based devices) then the AES-based options above for file name, file contents, and filesystem metadata encryption MUST be used, not Adiantum."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.2  . Per"	"9.9.3.2"	"C-1-5"	"9.9.3.2/C-1-5"	"09090302.670105"	"""C-1-5] MUST be cryptographically bound to a hardware-backed Keystore. This keystore MUST be bound to Verified Boot and the device's hardware root of trust."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-14"	"9.9.3.1/C-1-14"	"09090301.670114"	"""C-1-14] MUST NOT use the same File Based Encryption (FBE) keys or subkeys for different cryptographic purposes (e.g. for both encryption and key derivation, or for two different encryption algorithms). The keys protecting CE and DE storage areas and filesystem metadata:"""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"3.8.4  . Search"	"3.8.4"	"C-1-1"	"3.8.4/C-1-1"	"03080400.670101"	"""C-1-1] MUST implement the APIs that allow third-party applications to add suggestions to the search box when it is run in global search mode. If no third-party applications are installed that make use of the global search: The default behavior SHOULD be to display web search engine results and suggestions. Android also includes the Assist APIs to allow applications to elect how much information of the current context is shared with the assistant on the device. If device implementations support the Assist action, they:"""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	""	"9.9.3.1"	"09090301.48"	"""data-text="" 9.9.3.1. File Based Encryption with Metadata Encryption ""> 9.9.3.1. File Based Encryption with Metadata Encryption If device implementations use File Based Encryption with Metadata Encryption, they: [C-1-5] MUST encrypt file contents and filesystem metadata using AES-256-XTS or Adiantum. AES-256-XTS refers to the Advanced Encryption Standard with a 256-bit cipher key length, operated in XTS mode; the full length of the key is 512 bits. Adiantum refers to Adiantum-XChaCha12-AES, as specified at https://github.com/google/adiantum. Filesystem metadata is data such as file sizes, ownership, modes, and extended attributes (xattrs). [C-1-6] MUST encrypt file names using AES-256-CBC-CTS or Adiantum. [C-1-12] If the device has Advanced Encryption Standard (AES) instructions (such as ARMv8 Cryptography Extensions on ARM-based devices, or AES-NI on x86-based devices) then the AES-based options above for file name, file contents, and filesystem metadata encryption MUST be used, not Adiantum. [C-1-13] MUST use a cryptographically strong and non-reversible key derivation function (e.g. HKDF-SHA512) to derive any needed subkeys (e.g. per-file keys) from the CE and DE keys. ""Cryptographically strong and non-reversible"" means that the key derivation function has a security strength of at least 256 bits and behaves as a pseudorandom function family over its inputs. [C-1-14] MUST NOT use the same File Based Encryption (FBE) keys or subkeys for different cryptographic purposes (e.g. for both encryption and key derivation, or for two different encryption algorithms). The keys protecting CE and DE storage areas and filesystem metadata: [C-1-7] MUST be cryptographically bound to a hardware-backed Keystore. This keystore MUST be bound to Verified Boot and the device's hardware root of trust. [C-1-8] CE keys MUST be bound to a user's lock screen credentials. [C-1-9] CE keys MUST be bound to a default passcode when the user has not specified lock screen credentials. [C-1-10] MUST be unique and distinct, in other words no user's CE or DE key matches any other user's CE or DE keys. [C-1-11] MUST use the mandatorily supported ciphers, key lengths and modes. SHOULD make preinstalled essential apps (e.g. Alarm, Phone, Messenger) Direct Boot aware. The upstream Android Open Source project provides a preferred implementation of File Based Encryption based on the Linux kernel ""fscrypt"" encryption feature, and of Metadata Encryption based on the Linux kernel ""dm-default-key"" feature. <h4 id=""9_9_3_2_per-user_block-level_encryption"" """	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.2  . Per"	"9.9.3.2"	"C-1-6"	"9.9.3.2/C-1-6"	"09090302.670106"	"""C-1-6] MUST be bound to the corresponding user's lock screen credentials. Per-user block-level encryption can be implemented using the Linux kernel “dm-crypt” feature over per-user partitions. <h4 id=""9_9_4_resume_on_reboot"" """	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.5  . Multi"	"9.5"	"C-1-1"	"9.5/C-1-1"	"09050000.670101"	"""C-1-1] MUST meet the following requirements related to multi-user support."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.2  . Per"	"9.9.3.2"	"C-1-2"	"9.9.3.2/C-1-2"	"09090302.670102"	"""C-1-2] MUST provide per-user partitions, either using raw partitions or logical volumes."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-13"	"9.9.3.1/C-1-13"	"09090301.670113"	"""C-1-13] MUST use a cryptographically strong and non-reversible key derivation function (e.g. HKDF-SHA512) to derive any needed subkeys (e.g. per-file keys) from the CE and DE keys. ""Cryptographically strong and non-reversible"" means that the key derivation function has a security strength of at least 256 bits and behaves as a pseudorandom function family over its inputs."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
"9.9.3.1  . File Based Encryption with Metadata Encryption"	"9.9.3.1"	"C-1-7"	"9.9.3.1/C-1-7"	"09090301.670107"	"""C-1-7] MUST be cryptographically bound to a hardware-backed Keystore. This keystore MUST be bound to Verified Boot and the device's hardware root of trust."""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""	""
