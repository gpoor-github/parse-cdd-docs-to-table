"Section"	"section_id"	"req_id"	"requirement"	"Test Availability"	"class_def"	"method"	"module"
"270:744174) 9.9.3  . Encryption Methods"	"9.9.3"	"C-1-5"	"""C-1-5] MUST encrypt file contents and filesystem metadata using AES-256-XTS or Adiantum. AES-256-XTS refers to the Advanced Encryption Standard with a 256-bit cipher key length, operated in XTS mode; the full length of the key is 512 bits. Adiantum refers to Adiantum-XChaCha12-AES, as specified at https://github.com/google/adiantum. Filesystem metadata is data such as file sizes, ownership, modes, and extended attributes (xattrs)."""	"Annotated"	"android.security.cts.MetadataEncryptionTest"	"testMetadataEncryptionIsEnabled()"	"CtsSecurityHostTestCases"
"270:744174) 9.9.3  . Encryption Methods"	"9.9.3"	"C-1-6"	"""C-1-6] MUST encrypt file names using AES-256-CBC-CTS or Adiantum."""	"Found reference in comments"	"android.security.cts.MetadataEncryptionTest"	"testRequestBluetoothPermission30_Default() testRequestBluetoothPermission30_GrantLocation() testRequestBluetoothPermission31_Default() testRequestBluetoothPermission31_GrantNearby() testRequestBluetoothPermission31_GrantLocation() testRequestBluetoothPermission31_GrantNearby_GrantLocation() testRequestBluetoothPermissionNeverForLocation31_Default() testRequestBluetoothPermissionNeverForLocation31_GrantNearby() testRequestBluetoothPermissionNeverForLocation31_GrantLocation() testRequestBluetoothPermissionNeverForLocation31_GrantNearby_GrantLocation()"	"CtsSecurityHostTestCases"
"270:744174) 9.9.3  . Encryption Methods"	"9.9.3"	"C-1-7"	"""C-1-7] MUST be cryptographically bound to a hardware-backed Keystore. This keystore MUST be bound to Verified Boot and the device&#39;s hardware root of trust. """	""	""	""	""
"270:744174) 9.9.3  . Encryption Methods"	"9.9.3"	"C-1-8"	"""C-1-8] CE keys MUST be bound to a user&#39;s lock screen credentials."""	""	""	""	""
"270:744174) 9.9.3  . Encryption Methods"	"9.9.3"	"C-1-9"	"""C-1-9] CE keys MUST be bound to a default passcode when the user has not specified lock screen credentials."""	""	""	""	""
"270:744174) 9.9.3  . Encryption Methods"	"9.9.3"	"C-1-10"	"""C-1-10] MUST be unique and distinct, in other words no user&#39;s CE or DE key matches any other user&#39;s CE or DE keys."""	""	""	""	""
"270:744174) 9.9.3  . Encryption Methods"	"9.9.3"	"C-1-11"	"""C-1-11] MUST use the mandatorily supported ciphers, key lengths and modes."""	""	""	""	""
"270:744174) 9.9.3  . Encryption Methods"	"9.9.3"	"C-1-12"	"""C-1-12] If the device has Advanced Encryption Standard (AES) instructions (such as ARMv8 Cryptography Extensions on ARM-based devices, or AES-NI on x86-based devices) then the AES-based options above for file name, file contents, and filesystem metadata encryption MUST be used, not Adiantum. && C-1-12] If the device has Advanced Encryption Standard (AES) instructions (such as ARMv8 Cryptography Extensions on ARM-based devices, or AES-NI on x86-based devices) then the AES-based options above for file name, file contents, and filesystem metadata encryption MUST be used, not Adiantum. | C-1-12] MUST be securely erased during bootloader unlock and lock as described here. SHOULD make preinstalled essential apps (e.g. Alarm, Phone, Messenger) Direct Boot aware. The upstream Android Open Source project provides a preferred implementation of File Based Encryption based on the Linux kernel &quot;fscrypt&quot; encryption feature, and of Metadata Encryption based on the Linux kernel &quot;dm-default-key&quot; feature. <h4 id=""994_resume_on_reboot"" """	"Found reference in comments"	"cts/tests/tests/security/native/encryption/FileBasedEncryptionPolicyTest.cpp"	"validateEncryptionModes"	""
"270:744174) 9.9.3  . Encryption Methods"	"9.9.3"	"C-1-14"	"""C-1-14] MUST NOT use the same File Based Encryption (FBE) keys or subkeys for different cryptographic purposes (e.g. for both encryption and key derivation, or for two different encryption algorithms)."""	"Found reference in comments"	"cts/tests/tests/security/native/encryption/FileBasedEncryptionPolicyTest.cpp"	"FileBasedEncryptionPolicyTest_allowedPolicy"	""
"270:744174) 9.9.3  . Encryption Methods"	"9.9.3"	"C-1-15"	"""C-1-15] MUST ensure that all non-deleted blocks of encrypted file contents on persistent storage were encrypted using combinations of encryption key and initialization vector (IV) that depend on both the file and the offset within the file. In addition, all such combinations MUST be distinct, except where the encryption is done using inline encryption hardware that only supports an IV length of 32 bits. """	""	""	""	""
"270:744174) 9.9.3  . Encryption Methods"	"9.9.3"	"C-1-16"	"""C-1-16] MUST ensure that all non-deleted encrypted filenames on persistent storage in distinct directories were encrypted using distinct combinations of encryption key and initialization vector (IV). """	""	""	""	""
"270:744174) 9.9.3  . Encryption Methods"	"9.9.3"	"C-1-17"	"""C-1-17] MUST ensure that all encrypted filesystem metadata blocks on persistent storage were encrypted using distinct combinations of encryption key and initialization vector (IV). Have keys protecting CE and DE storage areas which: """	""	""	""	""
